(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/submit/submit"],{"0690":function(t,e,s){"use strict";s.r(e);var a=s("909f"),i=s.n(a);for(var d in a)"default"!==d&&function(t){s.d(e,t,function(){return a[t]})}(d);e["default"]=i.a},"2c2e":function(t,e,s){},"5b08":function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,a=(t._self._c,s("4573")),i=s("b818");t.$mp.data=Object.assign({},{$root:{m0:a,m1:i}})},i=[];s.d(e,"a",function(){return a}),s.d(e,"b",function(){return i})},8657:function(t,e,s){"use strict";var a=s("2c2e"),i=s.n(a);i.a},"909f":function(t,e,s){"use strict";(function(t,a){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=c(s("8c11")),d=c(s("9e8e")),n=c(s("8b8c")),o=s("d489"),r=s("c87f"),u=c(s("e0d7"));function c(t){return t&&t.__esModule?t:{default:t}}var l=function(){return Promise.all([s.e("common/vendor"),s.e("components/common/Pay")]).then(s.bind(null,"b0d6"))},f={data:function(){return{isBuyNow:"",submitData:"",list:[],defaultUrl:"https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=2180358788,168891397&fm=26&gp=0.jpg",isPay:!1,Checked:i.default,Uncheck:d.default,Plat:n.default,totalNum:0,totalMoney:0,address:"",message:"",deliverMoney:0,payOrderId:"",cartIdList:"",totalCount:""}},components:{Pay:l},onLoad:function(t){this.submitData=t.submitData,this.isBuyNow=t.isBuyNow},onShow:function(){var e=this;if(this.isBuyNow){var s=JSON.parse(this.submitData);t.getStorageSync("address")&&(this.address=JSON.parse(t.getStorageSync("address")),s.addressId=JSON.parse(t.getStorageSync("address")).id),(0,r.buyGood)(s).then(function(t){e.list=t.data.shopList,e.totalMoney=t.data.totalMoney,e.deliverMoney=t.data.deliverMoney,e.cartIdList=t.data.cartIdList,e.totalCount=t.data.totalCount})}else{if(this.submitData){var a=JSON.parse(this.submitData);this.list=a.shopList,this.totalMoney=a.totalMoney,this.deliverMoney=a.deliverMoney,this.cartIdList=a.cartIdList,this.totalCount=a.totalCount}t.getStorageSync("address")?(this.address=JSON.parse(t.getStorageSync("address")),this.getOrderCartByAddress(this.address.id)):this.getAddressDefAddress()}},methods:{doPay:function(){},doClose:function(){this.isPay=!1},goAddress:function(){t.navigateTo({url:"/pages/user/addlist/addlist?from=submit"})},showPay:function(){var t=this,e={shopParamList:this.list,postscript:this.message,addressId:this.address.id,cartIdList:this.cartIdList};(0,o.postCreateOrder)(e).then(function(e){"1000"===e.code?(t.isPay=""!==t.address,t.payOrderId=e.data.id):u.default.tips(e.message||"提交订单失败")}).catch(function(t){u.default.tips(t.message||"提交订单失败")})},getOrderCartByAddress:function(e){var s=this,a=t.getStorageSync("uid"),i={userId:a,cartIdList:this.cartIdList,addressId:this.address.id,postscript:this.message};if(this.isBuyNow){var d=JSON.parse(this.submitData);this.totalMoney=d.totalMoney,this.deliverMoney=d.deliverMoney}else(0,o.getOrderCart)(i).then(function(t){"1000"===t.code&&(s.totalMoney=t.data.totalMoney,s.deliverMoney=t.data.deliverMoney)}).catch(function(t){u.default.tips(t.message||"结算失败")})},submit:function(){if(""===this.address)return u.default.tips("请选择收货地址"),!1},goDetail:function(t,e){this.$router.push({path:"/gooddetail/"+t+"/"+e})},getAddressDefAddress:function(){var t=this;(0,o.getAddressDefAddress)().then(function(e){"1000"===e.code&&(t.address=e.data,t.getOrderCartByAddress(t.address.id))})},getCartList:function(){var t=this;(0,o.getCartOrderList)().then(function(e){if("1000"===e.code){if(e.data.cartLines&&e.data.cartLines.length>0){t.list=e.data.cartLines;var s=0,i=0;t.list.forEach(function(e,d){var n=!1;e.items.forEach(function(t,e){1===t.checked&&(n=!0,s+=t.num,i+=t.totalPrice)}),console.log(a(n+"==="+e.items.length," at pages\\order\\submit\\submit.vue:263")),n&&(t.list[d].checked=1)}),t.totalNum=s,t.totalMoney=i}}else u.default.tips(e.message||"获取进货单列表错误")}).catch(function(t){u.default.tips(t.message||"获取进货单列表错误")})}}};e.default=f}).call(this,s("6e42")["default"],s("0de9")["default"])},eb5b:function(t,e,s){"use strict";s.r(e);var a=s("5b08"),i=s("0690");for(var d in i)"default"!==d&&function(t){s.d(e,t,function(){return i[t]})}(d);s("8657");var n=s("2877"),o=Object(n["a"])(i["default"],a["a"],a["b"],!1,null,"1929a67c",null);e["default"]=o.exports},f6ee:function(t,e,s){"use strict";(function(t){s("b440"),s("921b");a(s("66fd"));var e=a(s("eb5b"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,s("6e42")["createPage"])}},[["f6ee","common/runtime","common/vendor"]]]);