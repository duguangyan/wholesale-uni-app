(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/order"],{"0b94":function(t,i,s){},"46f5":function(t,i,s){"use strict";var e=s("0b94"),c=s.n(e);c.a},"772b":function(t,i,s){"use strict";(function(t,e){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var c=r(s("8c11")),a=r(s("9e8e")),o=r(s("8b8c")),n=r(s("122c")),l=r(s("e0d7")),u=r(s("f585")),h=s("d489");function r(t){return t&&t.__esModule?t:{default:t}}var d=function(){return s.e("components/common/Dialog").then(s.bind(null,"3b86"))},f=function(){return s.e("components/common/TabBar").then(s.bind(null,"4d22"))},m={data:function(){return{checkIndex:1,hasData:!1,title:"您确定删除商品吗?",confirmText:"删除",cancelText:"再想想",isShow:!1,list:[],defaultUrl:"https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=2180358788,168891397&fm=26&gp=0.jpg",isEdit:!1,Checked:c.default,Uncheck:a.default,Plat:o.default,isCheckAll:!1,validTotal:0,validChecked:0,totalMoney:0,clickNum:0,isColor999:!1,isclock:!1,clock:!0,platform:0}},components:{Dialog:d,TabBar:f},onTabItemTap:function(t){},onLoad:function(){console.log(t("onLoad"," at pages\\order\\order.vue:139"))},onShow:function(){e.getStorageSync("access_token")?(this.getCartOrderList(),this.platform=e.getStorageSync("platform")):e.navigateTo({url:"/pages/login/login"})},methods:{doConfirm:function(){this.doDel()},doCancel:function(){this.isShow=!1},goDetail:function(t,i){e.navigateTo({url:"/pages/order/goodsDetail/goodsDetail?shopId="+t+"&goodsId="+i})},submit:function(){var t=this;if(!this.clock)return!1;this.clock=!1;var i=[];this.list.forEach(function(t){t.items.forEach(function(s){1==s.checked&&4!=t.status&&i.push(s.cartId)})});var s=e.getStorageSync("uid"),c={userId:s,cartIdList:i};(0,h.getOrderCart)(c).then(function(i){"1000"===i.code?(t.clock=!0,e.navigateTo({url:"/pages/order/submit/submit?submitData="+JSON.stringify(i.data)})):(l.default.tips(i.message||"结算失败"),t.clock=!0)}).catch(function(i){l.default.tips(i.message||"结算失败"),t.clock=!0})},goPay:function(){this.totalMoney>0?this.submit():l.default.tips("请选择进货单商品")},calculationTotalMoney:function(){var t=this;this.totalMoney=0,this.validTotal=0,this.list.forEach(function(i){i.items.forEach(function(i){1===i.checked&&4!==i.status&&(t.totalMoney=n.default.accAdd(t.totalMoney,i.totalPrice),t.validTotal++)})})},clickInput:function(t,i){this.clickNum=this.list[t].items[i].num},changInput:function(t,i,s){var e=t.target.value;u.default.isNumber(e)?e<this.list[i].items[s].startNum?(l.default.tips("数量不能小于起批量:"+this.list[i].items[s].startNum),this.list[i].items[s].num=this.list[i].items[s].startNum,this.changeNum(i,s,this.list[i].items[s].skuId,this.list[i].items[s].startNum)):e>this.list[i].items[s].stock?(l.default.tips("数量不能超过库存量:"+this.list[i].items[s].stock),this.list[i].items[s].num=this.list[i].items[s].stock,this.changeNum(i,s,this.list[i].items[s].skuId,this.list[i].items[s].stock)):this.changeNum(i,s,this.list[i].items[s].skuId,e):(l.default.tips("请输入正确的数量"),this.changeNum(i,s,this.list[i].items[s].skuId,this.list[i].items[s].startNum))},changeNum:function(i,s,e,c){var a=this;if(!this.isclock){var o={num:c,skuId:e,isLoading:1};this.isclock=!0,(0,h.getCartChangeNum)(o).then(function(e){"1000"===e.code?(a.list[i].items[s].num=e.data.num,a.list[i].items[s].price=e.data.price,a.list[i].items[s].totalPrice=e.data.totalPrice,a.list[i].items[s].isColor999=!1,a.calculationTotalMoney(),a.isclock=!1):(l.default.tips(e.message||"修改数量失败"),a.list[i].items[s].isColor999=!0,a.isclock=!1,console.log(t(a.list," at pages\\order\\order.vue:292")))}).catch(function(t){l.default.tips(t.message||"修改数量失败"),a.isColor999=!0,a.isclock=!1})}},doCalculation:function(i,s,e){if(0===i)if(this.list[s].items[e].num>this.list[s].items[e].startNum){var c=this.list[s].items[e].num;c--,console.log(t(this.clickNum," at pages\\order\\order.vue:306")),this.changeNum(s,e,this.list[s].items[e].skuId,c)}else l.default.tips("数量不能小于起批量:"+this.list[s].items[e].startNum);else if(this.list[s].items[e].num<this.list[s].items[e].stock){var a=this.list[s].items[e].num;a++,this.changeNum(s,e,this.list[s].items[e].skuId,a)}else l.default.tips("购买数量不能超过库存量:"+this.list[s].items[e].stock)},getCartHasCheck:function(i,s,e){var c=this,a={skuId:this.list[s].items[e].skuId};1===i?(0,h.getCartCheck)(a).then(function(a){c.list[s].items[e].checked=i,console.log(t(c.list," at pages\\order\\order.vue:330")),c.list.forEach(function(t,i){c.hasShopCheckedAll(i)}),c.hasCheckedAll()}).catch(function(t){l.default.tips(t.message||"选中失败")}):(0,h.getCartUncheck)(a).then(function(a){c.list[s].items[e].checked=i,console.log(t(c.list," at pages\\order\\order.vue:341")),c.list.forEach(function(t,i){c.hasShopCheckedAll(i)}),c.hasCheckedAll()}).catch(function(t){l.default.tips(t.message||"选中失败")})},checkChildrenIcon:function(t,i){var s=0===this.list[t].items[i].checked?1:0;this.getCartHasCheck(s,t,i)},hasCheckedAll:function(){var t=0;this.list.forEach(function(i){1===i.checked&&t++}),this.isCheckAll=t===this.list.length},hasShopCheckedAll:function(t){var i=0;this.list[t].items.forEach(function(t){1===t.checked&&i++}),this.list[t].checked=i===this.list[t].items.length?1:0,this.$set(this.list[t],"isColor999",!1),this.calculationTotalMoney()},checkAll:function(){var i=this,s=1;this.isCheckAll&&(s=0),this.isCheckAll=1===s,this.list.forEach(function(t,e){t.checked=s,i.list[e].items.forEach(function(t,c){i.list[e].items[c].checked=s})}),console.log(t(this.list," at pages\\order\\order.vue:394")),this.calculationTotalMoney()},checkParentIcon:function(t){var i=1;1===this.list[t].checked&&(i=0),this.list[t].checked=i,this.list[t].items.forEach(function(t){t.checked=i}),this.hasCheckedAll(),this.calculationTotalMoney()},goHome:function(){e.switchTab({url:"/pages/main/main"})},getCartOrderList:function(){var t=this;this.list=[],(0,h.getCartOrderList)().then(function(i){"1000"===i.code?(t.hasData=i.data.cartLines.length<=0,i.data.cartLines&&i.data.cartLines.length>0&&(t.list=i.data.cartLines,t.list.length>0&&(t.list.forEach(function(i,s){i.checked=0,t.hasShopCheckedAll(s)}),t.hasCheckedAll()))):t.hasData=!0})},preDel:function(){this.isShow=!0},doDel:function(){var i=this,s=[];this.list.forEach(function(t){t.items.forEach(function(t){1===t.checked&&s.push(t.skuId)})}),console.log(t(s," at pages\\order\\order.vue:451"));var e="";s.forEach(function(t,i){s.length-1===i?e+=t:e+=t+","});var c={skuIds:e};(0,h.getCartRemove)(c).then(function(t){"1000"===t.code?(i.isShow=!1,s.length>0?(i.list=[],i.getCartOrderList()):l.default.tips("请选择有效进货单")):l.default.tips(t.message||"删除进货单失败")}).catch(function(t){l.default.tips(t.message||"删除进货单失败")})}}};i.default=m}).call(this,s("0de9")["default"],s("6e42")["default"])},"78d3":function(t,i,s){"use strict";s.r(i);var e=s("b8bf"),c=s("9818");for(var a in c)"default"!==a&&function(t){s.d(i,t,function(){return c[t]})}(a);s("46f5");var o=s("2877"),n=Object(o["a"])(c["default"],e["a"],e["b"],!1,null,"e5323a12",null);i["default"]=n.exports},9818:function(t,i,s){"use strict";s.r(i);var e=s("772b"),c=s.n(e);for(var a in e)"default"!==a&&function(t){s.d(i,t,function(){return e[t]})}(a);i["default"]=c.a},b8bf:function(t,i,s){"use strict";var e=function(){var t=this,i=t.$createElement,e=(t._self._c,s("9bdb"));t._isMounted||(t.e0=function(i){t.isEdit=!t.isEdit}),t.$mp.data=Object.assign({},{$root:{m0:e}})},c=[];s.d(i,"a",function(){return e}),s.d(i,"b",function(){return c})},d13f:function(t,i,s){"use strict";(function(t){s("b440"),s("921b");e(s("66fd"));var i=e(s("78d3"));function e(t){return t&&t.__esModule?t:{default:t}}t(i.default)}).call(this,s("6e42")["createPage"])}},[["d13f","common/runtime","common/vendor"]]]);